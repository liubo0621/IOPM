<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybaits-3-mapper.dtd"><mapper namespace= "cn.com.pattek.SystemMoniter.dao.SystemMoniterDao">		<!-- 查询热点条数和最早时间 -->	<select id="selectHotRecordTimeAndCount"  resultType="java.util.HashMap">		select count(record_time) count, 		to_char(min(record_time), 'yyyy-mm-dd hh24:mi:ss') 		recordTime from TAB_IOPM_HOT_INFO 	</select>		<!-- 热点信息概述的数据(叙述)-->	<select id="selectViewData"  resultType="java.util.HashMap">		select count(distinct msg_id) count, action_type from TAB_IOPM_USER_ACTION 		where msg_type = 501 		group by  action_type	</select>	<!-- 热点被采纳数据 -->	<select id="selectAccept"  parameterType="java.lang.Integer" resultType="java.util.HashMap">		select t.msg_id, h.title, count(msg_id) count from TAB_IOPM_USER_ACTION t, tab_iopm_hot_info h 		where t.action_type = 301 		and t.msg_type = 501 		and h.id = t.msg_id 		and t.RECORD_TIME 		<![CDATA[		>=sysdate - ${value}		]]> group by t.msg_id, h.title 		order by count desc	</select>	<!-- 热点未采纳数据 -->		<select id="selectUnAccept"  parameterType="java.lang.Integer" resultType="java.util.HashMap">		select t.msg_id, h.title, count(msg_id) count from TAB_IOPM_USER_ACTION t, tab_iopm_hot_info h 		where t.action_type = 302 		and t.msg_type = 501 		and h.id = t.msg_id 		and t.RECORD_TIME 		<![CDATA[		>=sysdate - ${value}		]]> 		group by t.msg_id, h.title 		order by count desc	</select> 	<!-- 热点信息趋势统计-折线图数据1--> 	<select id="selectTrendData"  parameterType="java.lang.String" resultType="java.util.HashMap">		select 			record_time, action_type, count(distinct msg_id) count		from 			(		select 			to_char(record_Time, 'yyyy-MM-dd') record_time, action_type, msg_id		from 			TAB_IOPM_USER_ACTION		where 			msg_type = 501		and 			action_type != 303		and 			Record_Time &gt;=to_date(#{afterDate}, 'yyyy-MM-dd HH24:MI:SS')		and 			Record_Time &lt;=to_date(#{formatNow}, 'yyyy-MM-dd HH24:MI:SS')		)			group by record_time, action_type			order by record_time	</select> 	<!-- 热点信息趋势统计-折线图数据2-->		<select id="selectHotCount"  parameterType="java.lang.String" resultType="java.util.HashMap">	select 		to_char(record_time,'yyyy-MM-dd'), count(record_time) count	from 		TAB_IOPM_HOT_INFO	where 		record_time &gt;=to_date(#{afterDate}, 'yyyy-MM-dd HH24:MI:SS')	and 		record_time &lt;=to_date(#{formatNow}, 'yyyy-MM-dd HH24:MI:SS')		group by to_char(record_time,'yyyy-MM-dd')		order by to_char(record_time,'yyyy-MM-dd')				</select>		<!-- 热点信息趋势统计-概述-->		<select id="dataHot"  parameterType="java.lang.Integer" resultType="java.lang.Integer">		select  			count(*) count from TAB_IOPM_HOT_INFO t  		where 			t.record_time &gt;= sysdate-#{dateCount} 	</select>		<!-- 热点信息趋势统计-概述-->		<select id="dataAllHot"  parameterType="java.lang.Integer" resultType="java.util.HashMap"> 		select  			count(distinct msg_id) count, action_type from TAB_IOPM_USER_ACTION t  		where  			msg_type = 501  		AND  			t.record_time &gt;= sysdate-#{dateCount}  			group by  action_type 	</select>			<!-- 查询舆情条数和最早时间 -->	<select id="selectArticleRecordTimeAndCount"  resultType="java.util.HashMap">	select count(record_time) count, 	to_char(min(record_time), 'yyyy-mm-dd hh24:mi:ss') 	recordTime from TAB_IOPM_ARTICLE_INFO 	</select>	<!-- 舆情信息概述的数据(叙述)-->	<select id="selectArticleTimeAndCount"  resultType="java.util.HashMap">	select count(distinct msg_id) count, action_type from TAB_IOPM_USER_ACTION 	where msg_type = 502 group by  action_type	</select>	<!-- 舆情被采纳数据 -->	<select id="selectArticleAccept"  parameterType="java.lang.Integer" resultType="java.util.HashMap">		select t.msg_id, h.title, count(msg_id) count from TAB_IOPM_USER_ACTION t, TAB_IOPM_ARTICLE_INFO h 		where t.action_type = 301 		and t.msg_type = 502 		and h.id = t.msg_id 		and t.RECORD_TIME 		<![CDATA[		>=sysdate - ${value}		]]> 		group by t.msg_id, h.title 		order by count desc	</select>	<!-- 舆情未采纳数据 -->		<select id="selectArticleUnAccept"  parameterType="java.lang.Integer" resultType="java.util.HashMap">		select t.msg_id, h.title, count(msg_id) count from TAB_IOPM_USER_ACTION t, TAB_IOPM_ARTICLE_INFO h 		where t.action_type = 302 		and t.msg_type = 502 		and h.id = t.msg_id 		and t.RECORD_TIME 		<![CDATA[		>=sysdate - ${value}		]]> 		group by t.msg_id, h.title 		order by count desc	</select> 		<!-- 舆情信息趋势统计-折线图数据1--> 	<select id="selectArticleTrendData"  parameterType="java.lang.String" resultType="java.util.HashMap">    	select 			record_time, action_type, count(distinct msg_id) count		from 			(		select 			to_char(record_Time, 'yyyy-MM-dd') record_time, action_type, msg_id		from 			TAB_IOPM_USER_ACTION		where 			msg_type = 502		and 			Record_Time &gt;=to_date(#{afterDate}, 'yyyy-MM-dd HH24:MI:SS')		and 			Record_Time &lt;=to_date(#{formatNow}, 'yyyy-MM-dd HH24:MI:SS')		)			group by record_time, action_type			order by record_time	</select> 	<!-- 舆情信息趋势统计-折线图数据-总数-->		<select id="selectArticleCount"  parameterType="java.lang.String" resultType="java.util.HashMap">	select 		to_char(record_time,'yyyy-MM-dd'), count(record_time) count	from 		TAB_IOPM_ARTICLE_INFO	where 		record_time &gt;=to_date(#{afterDate}, 'yyyy-MM-dd HH24:MI:SS')	and 		record_time &lt;=to_date(#{formatNow}, 'yyyy-MM-dd HH24:MI:SS')		group by to_char(record_time,'yyyy-MM-dd')		order by to_char(record_time,'yyyy-MM-dd')	</select>	<!-- 舆情信息趋势统计-折线图数据3--> 	<select id="selectArticleTrendTypeData"  parameterType="java.lang.String" resultType="java.util.HashMap"> 	select       	record_time, info_type, count(distinct id) count    from       	(    select      	 to_char(record_Time, 'yyyy-MM-dd') record_time, info_type,id    from      	 TAB_IOPM_ARTICLE_INFO    where      	 info_type >0    and       	record_time &gt;=to_date(#{afterDate}, 'yyyy-MM-dd HH24:MI:SS')	and 		record_time &lt;=to_date(#{formatNow}, 'yyyy-MM-dd HH24:MI:SS')    	)      	group by record_time, info_type     	 order by record_time	</select>		<!-- 舆情信息趋势统计-概述 -->		<select id="dataArticle"  parameterType="java.lang.Integer" resultType="java.lang.Integer">			select  			count(*) count from TAB_IOPM_ARTICLE_INFO t  		where 			t.record_time &gt;= sysdate-#{dateCount} 	</select>				<!-- 热点信息趋势统计-概述-->		<select id="dataAllArticle"  parameterType="java.lang.Integer" resultType="java.util.HashMap"> 		select  			count(distinct msg_id) count, action_type from TAB_IOPM_USER_ACTION t  		where  			msg_type = 502  		AND  			t.record_time &gt;= sysdate-#{dateCount}  			group by  action_type 	</select>				<!-- 线索库监控-线索概述-获得线索条数 -->	<select id="cluesCount" resultType="java.lang.Integer">		select 			count(*) 		from			TAB_IOPM_CLUES	</select>	<!-- 线索库监控-线索概述-获得关键词数量 -->	<select id="keyWordsCount" resultType="java.lang.Integer">		select 			count(*) 		from 			TAB_IOPM_CLUES_KEYWORDS		</select>	<!-- 线索库监控-线索概述-获得类别数量 -->	<select id="secondCluesClassify" resultType="java.lang.Integer">		select 			count(*) 		from 			TAB_IOPM_SECOND_CLUES_CLASSIFY	</select>	<!-- 线索库监控-线索概述-最晚同步时间以及同步情况 -->	<select id="rerocdInfo" parameterType="java.lang.Integer" resultType="java.util.HashMap">		select 			* 		from 			TAB_IOPM_CLUES_SYNC_INFO t 		where 			to_char(t.rerocd_time, 'yyyy-mm-dd hh24:mi:ss') =to_char((select max(t.REROCD_TIME) from TAB_IOPM_CLUES_SYNC_INFO t), 'yyyy-mm-dd hh24:mi:ss')	</select>		<select id="rangeData" parameterType="java.util.Map" resultType="java.util.HashMap">	  		select 			nvl(t.delete_count,0) DELETE_COUNT,nvl(t.Update_Count,0) UPDATE_COUNT,nvl(t.Save_Count,0) SAVE_COUNT,nvl(t.Worn_Clues_Count,0) WORN_CLUES_COUNT,to_char(t.REROCD_TIME,'yyyy-MM-dd HH24:MI:SS') TIME,t.total,t.message 		from 			TAB_IOPM_CLUES_SYNC_INFO t 		where 			t.rerocd_time &gt;= sysdate - #{dateCount} 		and 			SYNC_TYPE =#{type}			order by 			t.REROCD_TIME		</select>		<!-- 通过阈值得出数据(活跃) -->	<select id="activeCluesAndZeroIdName" parameterType="java.util.Map" resultType="java.util.HashMap">		select 			c.zero_name classifyName,b.Name clueName ,k.keyword2 clueWord, k.msg_count infoCount		from 			(select * from TAB_IOPM_CLUES_KEYWORDS t where t.msg_count &gt;= #{count} order by t.msg_count desc) k,TAB_IOPM_ZERO_CLUES_CLASSIFY c ,TAB_IOPM_CLUES b 		where 			k.ZERO_ID=c.zero_id 		and 			k.Clues_Id=b.id			</select>		<!-- 数量获取(活跃) -->	<select id="variousTotal" parameterType="java.util.Map" resultType="java.lang.Integer">		select 			count(*) 		from 			TAB_IOPM_CLUES_KEYWORDS t  			<choose>				<when test="msgCount==null and zeroId==null"> <!-- 所有参数都没有,得出全部信息条数 -->								</when>								<when test="msgCount!=null and zeroId==null"> <!-- 得出所有大于msgCount 的数据 -->						where t.msg_count &gt;= #{msgCount}				</when>							<when test="msgCount==null and zeroId!=null"> <!-- 得出所有zeroId为指定类型的数量 -->					where t.zero_id = #{zeroId}				</when>								<when test="msgCount!=null and zeroId!=null">					where t.msg_count &gt;= #{msgCount}					and t.zero_id = #{zeroId}				</when>							</choose>	</select>		<!-- 通过阈值得出数据(僵尸) -->	<select id="zombieCluesAndZeroIdName" parameterType="java.util.Map" resultType="java.util.HashMap">		select 			c.zero_name classifyName,b.Name clueName ,k.keyword2 clueWord, k.msg_count infoCount		from 			(select * from TAB_IOPM_CLUES_KEYWORDS t where t.msg_count &lt;= #{count} order by t.msg_count desc) k,TAB_IOPM_ZERO_CLUES_CLASSIFY c ,TAB_IOPM_CLUES b 		where 			k.ZERO_ID=c.zero_id 		and 			k.Clues_Id=b.id			</select>		<!-- 数量获取(僵尸) -->	<select id="zombievariousTotal" parameterType="java.util.Map" resultType="java.lang.Integer">		select 			count(*) 		from 			TAB_IOPM_CLUES_KEYWORDS t  			<choose>				<when test="msgCount==null and zeroId==null"> <!-- 所有参数都没有,得出全部信息条数 -->								</when>								<when test="msgCount!=null and zeroId==null"> <!-- 得出所有大于msgCount 的数据 -->						where t.msg_count &lt;= #{msgCount}				</when>							<when test="msgCount==null and zeroId!=null"> <!-- 得出所有zeroId为指定类型的数量 -->					where t.zero_id = #{zeroId}				</when>								<when test="msgCount!=null and zeroId!=null">					where t.msg_count &lt;= #{msgCount}					and t.zero_id = #{zeroId}				</when>							</choose>	</select>		<!-- 添加版本信息 -->	<insert id="addLog" parameterType="java.util.Map">		insert into tab_iopm_tag		<trim prefix="(" suffix=")" suffixOverrides=",">			<if test="id!=null">				id,			</if>			<if test="title!=null">				title,			</if>			<if test="content!=null">				content,			</if>			<if test="releaseTime!=null">				release_Time,			</if>			<if test="tag!=null">				tag,			</if>		</trim>		<trim prefix="values (" suffix=")" suffixOverrides=",">			<if test="id!=null">				#{id},			</if>			<if test="title!=null">				#{title},			</if>			<if test="content!=null">				#{content},			</if>			<if test="releaseTime!=null">				to_date(#{releaseTime}, 'yyyy-mm-dd hh24:mi:ss'),			</if>			<if test="tag!=null">				#{tag},			</if>		</trim>		</insert>		  <!-- 查出Tag -->	<select id="selectIdAndTag"  resultType="java.lang.Integer">		select 			seq_iopm_tag.nextval  		from dual	</select>		<select id="selectLog" resultType="java.util.HashMap">		select 			to_char(t.release_time,'yyyy-MM-dd hh24:mi:ss') release_time,t.id,t.title,t.tag,to_char(t.content) content		from 			TAB_IOPM_TAG t	</select>	</mapper>